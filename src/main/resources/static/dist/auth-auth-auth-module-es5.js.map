{"version":3,"sources":["webpack:///./src/app/auth/auth/login/login.component.html","webpack:///./src/app/auth/auth/auth-routing.module.ts","webpack:///./src/app/auth/auth/auth.module.ts","webpack:///./src/app/auth/auth/login/login.component.scss","webpack:///./src/app/auth/auth/login/login.component.ts","webpack:///./src/app/service/core2.ts","webpack:///./src/app/service/jwt.interceptor.service.ts"],"names":[],"mappings":"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","file":"auth-auth-auth-module-es5.js","sourcesContent":["module.exports = \"<h1 id=\\\"title\\\" class=\\\"title\\\">Đăng nhập</h1>\\r\\n<p class=\\\"sub-title\\\">Xin chào! Hãy đăng nhập để tiếp tục.</p>\\r\\n\\r\\n<nb-alert *ngIf=\\\"showMessages.error && errors?.length && !submitted\\\" outline=\\\"danger\\\" role=\\\"alert\\\">\\r\\n  <p class=\\\"alert-title\\\"><b>Oh snap!</b></p>\\r\\n  <ul class=\\\"alert-message-list\\\">\\r\\n    <li *ngFor=\\\"let error of errors\\\" class=\\\"alert-message\\\">{{ error }}</li>\\r\\n  </ul>\\r\\n</nb-alert>\\r\\n\\r\\n<nb-alert *ngIf=\\\"showMessages.success && messages?.length && !submitted\\\" outline=\\\"success\\\" role=\\\"alert\\\">\\r\\n  <p class=\\\"alert-title\\\"><b>Hooray!</b></p>\\r\\n  <ul class=\\\"alert-message-list\\\">\\r\\n    <li *ngFor=\\\"let message of messages\\\" class=\\\"alert-message\\\">{{ message }}</li>\\r\\n  </ul>\\r\\n</nb-alert>\\r\\n\\r\\n<form (ngSubmit)=\\\"login()\\\" #form=\\\"ngForm\\\" aria-labelledby=\\\"title\\\">\\r\\n\\r\\n  <div class=\\\"form-control-group\\\">\\r\\n    <label class=\\\"label\\\" for=\\\"username\\\">Tài khoản:</label>\\r\\n    <input type=\\\"text\\\"\\r\\n     nbInput \\r\\n     placeholder=\\\"Tài khoản\\\" \\r\\n     style=\\\"width:100%\\\" \\r\\n     [(ngModel)]=\\\"user.username\\\"\\r\\n     name=\\\"username\\\" \\r\\n     id=\\\"username\\\"\\r\\n     fullWidth\\r\\n     autofocus\\r\\n     >\\r\\n\\r\\n  </div>\\r\\n\\r\\n  <div class=\\\"form-control-group\\\">\\r\\n    <label class=\\\"label\\\" for=\\\"input-password\\\">Mật khẩu:</label>\\r\\n    <input nbInput\\r\\n           fullWidth\\r\\n           [(ngModel)]=\\\"user.password\\\"\\r\\n           #password=\\\"ngModel\\\"\\r\\n           name=\\\"password\\\"\\r\\n           type=\\\"password\\\"\\r\\n           id=\\\"input-password\\\"\\r\\n           placeholder=\\\"Password\\\"\\r\\n           [status]=\\\"password.dirty ? (password.invalid  ? 'danger' : 'success') : ''\\\"\\r\\n           [required]=\\\"getConfigValue('forms.validation.password.required')\\\"\\r\\n           [minlength]=\\\"getConfigValue('forms.validation.password.minLength')\\\"\\r\\n           [maxlength]=\\\"getConfigValue('forms.validation.password.maxLength')\\\"\\r\\n           [attr.aria-invalid]=\\\"password.invalid && password.touched ? true : null\\\">\\r\\n    <ng-container *ngIf=\\\"password.invalid && password.touched \\\">\\r\\n      <p class=\\\"error-message\\\" *ngIf=\\\"password.errors?.required\\\">\\r\\n        Chưa nhập mật khẩu!\\r\\n      </p>\\r\\n      <p class=\\\"error-message\\\" *ngIf=\\\"password.errors?.minlength || password.errors?.maxlength\\\">\\r\\n        Mật khẩu phải\\r\\n        từ {{ getConfigValue('forms.validation.password.minLength') }}\\r\\n        tới {{ getConfigValue('forms.validation.password.maxLength') }}\\r\\n        kí tự\\r\\n      </p>\\r\\n    </ng-container>\\r\\n  </div>\\r\\n\\r\\n  <div class=\\\"form-control-group accept-group\\\">\\r\\n    <nb-checkbox name=\\\"rememberMe\\\" [(ngModel)]=\\\"user.rememberMe\\\" *ngIf=\\\"rememberMe\\\">Nhớ tài khoản</nb-checkbox>\\r\\n    <a class=\\\"forgot-password\\\" routerLink=\\\"../request-password\\\">Quên mật khẩu!</a>\\r\\n  </div>\\r\\n\\r\\n  <button nbButton\\r\\n          fullWidth\\r\\n          status=\\\"success\\\"\\r\\n          [disabled]=\\\"submitted || !form.valid\\\"\\r\\n          [class.btn-pulse]=\\\"submitted\\\">\\r\\n    Đăng nhập\\r\\n  </button>\\r\\n</form>\\r\\n\\r\\n\\r\\n<!-- <section class=\\\"another-action\\\" aria-label=\\\"Register\\\">\\r\\n  Nếu bạn chưa có tài khoản? <a class=\\\"text-link\\\" routerLink=\\\"../register\\\">Kế</a>\\r\\n</section> -->\"","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { NbAuthComponent } from '@nebular/auth';\r\nimport { LoginComponent } from './login/login.component';\r\n\r\nexport const routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: NbAuthComponent,  // <---\r\n    children: [\r\n      {\r\n        path: 'login',\r\n        component: LoginComponent, // <---\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class AuthModuleRouting{\r\n\r\n}","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { RouterModule } from '@angular/router';\r\nimport { NbAlertModule, NbInputModule, NbButtonModule, NbCheckboxModule } from '@nebular/theme';\r\nimport { NbAuthModule } from '@nebular/auth';\r\nimport { AuthModuleRouting } from './auth-routing.module';\r\nimport { LoginComponent } from './login/login.component';\r\nimport { AuthService } from '../../service/auth-service.service';\r\nimport { MyCoreModule } from '../../service/core2';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    RouterModule,\r\n    NbAlertModule,\r\n    NbInputModule,\r\n    NbButtonModule,\r\n    NbCheckboxModule,\r\n    AuthModuleRouting,\r\n\r\n    NbAuthModule,\r\n    MyCoreModule,\r\n  ],\r\n  declarations: [\r\n  LoginComponent],\r\n  providers:[AuthService]\r\n})\r\nexport class AuthModule { }\r\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2F1dGgvYXV0aC9sb2dpbi9sb2dpbi5jb21wb25lbnQuc2NzcyJ9 */\"","import { Component, OnInit, ChangeDetectorRef, Inject } from '@angular/core';\r\nimport { NbLoginComponent, NbAuthService, NB_AUTH_OPTIONS } from '@nebular/auth';\r\nimport { Router } from '@angular/router';\r\nimport { AuthService } from '../../../service/auth-service.service';\r\nimport { TokenStorageService } from '../../../service/tokenstorage.service';\r\nimport { CustomerControllerService } from '../../../../typescript-angular-client';\r\nimport { Logger } from '../../../log.service';\r\n\r\n@Component({\r\n  selector: 'ngx-login',\r\n  templateUrl: './login.component.html',\r\n  styleUrls: ['./login.component.scss'],\r\n  providers:[AuthService,CustomerControllerService]\r\n})\r\nexport class LoginComponent  extends NbLoginComponent  implements OnInit {\r\n  isLoggedIn = false;\r\n  isLoginFailed = false;\r\n  roles: string[] = [];\r\n  constructor(\r\n    private log:Logger,\r\n    private customerControllerService: CustomerControllerService,\r\n    private authService:AuthService, private tokenStorageService:TokenStorageService,\r\n    private nbAuthServe:NbAuthService,@Inject(NB_AUTH_OPTIONS) options:{},cd: ChangeDetectorRef, router: Router){\r\n    super(nbAuthServe,options,cd,router);\r\n    \r\n  }\r\n  login(){\r\n    this.log.log(this.user);\r\n    let loginTrue = this.authService.login(this.user);\r\n    this.log.logAny(loginTrue);\r\n    this.router.navigate([\"/store\"]);\r\n\r\n  }\r\n  ngOnInit() {\r\n    if(this.authService.isAuthenticated()){\r\n      this.isLoggedIn=true;\r\n    }\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { HttpClientModule, HTTP_INTERCEPTORS } from '@angular/common/http';\r\nimport { JwtInterceptorService } from './jwt.interceptor.service';\r\n\r\n@NgModule({\r\n    imports: [\r\n      CommonModule,\r\n      HttpClientModule\r\n    ],\r\n    declarations: [],\r\n    providers: [\r\n      {\r\n        provide: HTTP_INTERCEPTORS,\r\n        useClass: JwtInterceptorService,\r\n        multi: true,\r\n      },JwtInterceptorService\r\n    ]\r\n  })\r\nexport class MyCoreModule{}","import { Injectable } from '@angular/core';\r\nimport { HttpInterceptor, HttpRequest, HttpHandler, HttpEvent, HTTP_INTERCEPTORS, HttpResponse, HttpErrorResponse } from '@angular/common/http';\r\nimport { Observable, of } from 'rxjs';\r\nimport { TokenStorageService } from './tokenstorage.service';\r\nimport { NbAuthJWTInterceptor } from '@nebular/auth';\r\nimport { map, catchError } from 'rxjs/operators';\r\nimport { Logger } from '../log.service';\r\nimport { Router } from '@angular/router';\r\nimport { ToastrService } from '../pages/sharedmodule/toast';\r\nconst TOKEN_HEADER_KEY = 'Authorization';\r\nconst CONTENTTYPE = 'Content-Type';\r\nconst ACCEPT = 'Accept';\r\nconst APPJSON = 'application/json';\r\n@Injectable({ providedIn: 'root' })\r\nexport class JwtInterceptorService implements HttpInterceptor {\r\n\r\n  constructor(\r\n    private token: TokenStorageService, \r\n    private log: Logger,\r\n    private router:Router,\r\n    private toast:ToastrService) { }\r\n  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\r\n    const token = this.token.getToken();\r\n    if (!req.headers.has(CONTENTTYPE)) {\r\n      req = req.clone({ setHeaders: { 'Content-Type': 'application/json' } })\r\n    }\r\n    if (!req.headers.has(ACCEPT)) {\r\n      req = req.clone({ setHeaders: { 'Accept': 'application/json' } })\r\n    }\r\n    if (token !== null) {\r\n      req = req.clone({ setHeaders: { 'Authorization': 'Bearer ' + token } })\r\n    }\r\n    return next.handle(req).pipe(\r\n      catchError(error => {\r\n        if (error instanceof HttpErrorResponse) {\r\n          switch (error.status) {\r\n            case 400:\r\n              console.log(400);\r\n              return Observable.throw(error);\r\n            case 401:\r\n              console.log(401);\r\n              this.token.clear();\r\n              this.router.navigate(['auth/login']);\r\n              return Observable.throw(error);\r\n            case 403:\r\n              console.log(403);\r\n              this.toast.notify(4,\"Quyền\",\"Bạn không có quyền truy cập.\");\r\n              return Observable.throw(error);\r\n            case 500:\r\n              this.toast.notify(4,\"Lỗi\",error.error.message);\r\n          }\r\n        }else{\r\n\r\n        }\r\n      })\r\n    );\r\n  }\r\n  /**\r\n   * manage errors\r\n   * @param err\r\n   * @returns {any}\r\n   */\r\n  private handleAuthError(err: HttpErrorResponse): Observable<any> {\r\n    //handle your auth error or rethrow\r\n    if (err.status === 401) {\r\n        //navigate /delete cookies or whatever\r\n        console.log('handled error ' + err.status);\r\n        this.router.navigate(['auth/login']);\r\n        // if you've caught / handled the error, you don't want to rethrow it unless you also want downstream consumers to have to handle it as well.\r\n        return of(err.message);\r\n    }\r\n    throw err;\r\n}\r\n\r\n\r\n\r\n}\r\nexport const authInterceptorProviders = [\r\n  { provide: HTTP_INTERCEPTORS, useClass: JwtInterceptorService, multi: true }\r\n];\r\n"],"sourceRoot":""}